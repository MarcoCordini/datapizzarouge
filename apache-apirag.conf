# DataPizzaRouge API - Apache Reverse Proxy Configuration
# Da includere nel VirtualHost di gemellidigitali.almapro.it

# Proxy pass per l'API (mantiene il path /apirag)
ProxyPass /apirag http://127.0.0.1:8000 timeout=300
ProxyPassReverse /apirag http://127.0.0.1:8000

<Location /apirag>
    # Preserva headers per FastAPI e Swagger UI
    ProxyPreserveHost On
    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Prefix "/apirag"
    RequestHeader set X-Forwarded-Host "gemellidigitali.almapro.it"

    # Headers per CORS (se necessario)
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS, DELETE, PUT"
    Header set Access-Control-Allow-Headers "Content-Type, Authorization"
</Location>

# CORS headers (se non gi√† gestiti da FastAPI)
<IfModule mod_headers.c>
    # Allow CORS from Blazor app
    Header always set Access-Control-Allow-Origin "*"
    Header always set Access-Control-Allow-Methods "GET, POST, OPTIONS, DELETE, PUT"
    Header always set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
    Header always set Access-Control-Max-Age "3600"
</IfModule>
